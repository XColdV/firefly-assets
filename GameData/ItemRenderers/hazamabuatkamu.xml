<?xml version="1.0"?>
<ItemRenderer>
	<RenderRules>
		<RenderInFront>
			<SpriteRender name="p_item" offset="2,-9996" scale="0.2,0.2" alignment="DOWN_CENTER" onState="Action1.Punch"/>
			<SpriteRender name="s_punch" offset="5,-9996" scale="1.5,1.5" alignment="DOWN_CENTER" rotateOffset="true" onState="Action1.Punch"/>
			<StopIf type="and">
				<IsAction>PUNCH</IsAction>
			</StopIf>        
			<SpriteRender name="s_item" offset="2,-9996" scale="0.2,0.2" alignment="DOWN_CENTER"/>
        </RenderInFront>
        
		<OnDestroyedTile>
		  <ParticleSystemUpdate name="break_particle"/>
		</OnDestroyedTile>          
        
		<AddClothingParticles>
			<ParticleSystemUpdate name="particle_shadowright" onState="Facing.Right" onAction="WALK|JUMP|FALL"/>
            <ParticleSystemUpdate name="particle_shadowleft" onState="Facing.Left" onAction="WALK|JUMP|FALL"/>
            <ParticleSystemUpdate name="particle_trail" onAction="WALK|JUMP|FALL"/>        
    	</AddClothingParticles>        
	</RenderRules>

    
    	<Data>
		<Sprite name="s_item" fileName="game/h7.rttex" textureSize="512,420"/>
		<Sprite name="p_item" fileName="game/h7.rttex" textureSize="512,420" frame="0,2"/>
		<Sprite name="s_shadow" fileName="game/h7x.rttex" textureSize="512,420" frame="0,0"/>

		<Sprite name="s_punch" fileName="game/hzam.rttex" textureSize="64" frame="24,13"/>
		<Sprite name="s_trail" fileName="game/ci_n4.rttex" textureSize="32" frame="9,38"/>
		<Sprite name="s_break" fileName="game/ci_n4.rttex" textureSize="32" frame="10,38"/>
		<Sprite name="s_death" fileName="game/ci_n4.rttex" textureSize="32" frame="9,39"/>

		<Sprite name="s_break2" fileName="game/particles.rttex" textureSize="32" frame="3,0"/>
	
    	<Animations>
			<SpriteAnimation name="idle" isLoop="true" playOnState="Motion.Idle" sprite="s_item" animTime="900">
                <Frame>0,0</Frame>
                <Frame>1,0</Frame>
                <Frame>2,0</Frame>
                <Frame>3,0</Frame>
                <Frame>4,0</Frame>
                <Frame>5,0</Frame>                
            </SpriteAnimation>
			<SpriteAnimation name="walk" isLoop="true" playOnState="Motion.Move" sprite="s_item" animTime="700">
                <Frame>0,1</Frame>
                <Frame>1,1</Frame>
                <Frame>2,1</Frame>
                <Frame>3,1</Frame>                
                <Frame>4,1</Frame>
			</SpriteAnimation>
			<SpriteAnimation name="jump" isLoop="false" sprite="s_item" playOnState="Motion.Jump">
                <Frame>4,3</Frame>
			</SpriteAnimation>
			<SpriteAnimation name="fall" isLoop="false" sprite="s_item" playOnState="Motion.Fall">
				<Frame>5,3</Frame>
			</SpriteAnimation>
            <SpriteAnimation name="punch" isLoop="true" playOnState="Action1.Punch" sprite="p_item" animTime="600">
                <Frame>0,2</Frame>
                <Frame>1,2</Frame>
                <Frame>2,2</Frame>
                <Frame>3,2</Frame>
                <Frame>4,2</Frame>
                <Frame>5,2</Frame>   
                <Frame>0,3</Frame>
                <Frame>1,3</Frame>
                <Frame>2,3</Frame>  
                <Frame>3,3</Frame>
            </SpriteAnimation>  
            <SpriteAnimation name="a_punch" sprite="s_punch" animTime="250" isLoop="true" playOnState="Action1.Punch">
                <Frame>24,13</Frame>
                <Frame>25,13</Frame>
                <Frame>26,13</Frame>
                <Frame>27,13</Frame>
                <Frame>28,13</Frame>
                <Frame>29,13</Frame>
                <Frame>30,13</Frame>
            </SpriteAnimation>     
			<SpriteAnimation name="shadow" isLoop="true" sprite="s_shadow" animTime="700">
                <Frame>0,0</Frame>
                <Frame>1,0</Frame>
                <Frame>2,0</Frame>
                <Frame>3,0</Frame>                
                <Frame>4,0</Frame>
			</SpriteAnimation>    
	        <SpriteAnimation name="break2" autoPlay="true" sprite="s_break2" animTime="1200">
    	        <Frame>3,0</Frame>
	            <Frame>4,0</Frame>
	        </SpriteAnimation>                               
		</Animations>
                 
		<ParticleSystems>                   
			<ParticleSystem name="particle_shadowright" updateState="Facing.Right">
				<Emitter usePlayerFacing="true">
					<Set name="offset">-3,-5018</Set>
                    <Set name="offsetFacing">true</Set>
					<Set name="infLifeTime">true</Set>
                    <Set name="emissionInterval">0.25</Set>
					<Set name="infParticles">true</Set>
					<Set name="particlesPerEmission">1</Set>
				</Emitter>
				<Particle>
					<Set name="sprite">s_shadow</Set>
					<Random name="offset" min="-8,-5020" max="8,-5020"/>
					<Set name="lifeTime">0.7</Set>
                    <Set name="inSpecificOrder">true</Set>
					<Set name="isBackgroundParticle">true</Set>
					<Set name="useGravity">false</Set>
					<Set name="gravityVector">0,25</Set>
					<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 0.8</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
					<Curve name="initialScale">
						<KeyFrame>0, 0.2, 0.2</KeyFrame>
						<KeyFrame>1, 0.2, 0.2</KeyFrame>
					</Curve>
				</Particle>
			</ParticleSystem>          
			<ParticleSystem name="particle_shadowleft" updateState="Facing.Left">
				<Emitter usePlayerFacing="true">
					<Set name="offset">-3,-5018</Set>
                    <Set name="offsetFacing">true</Set>
					<Set name="infLifeTime">true</Set>
                    <Set name="emissionInterval">0.25</Set>
					<Set name="infParticles">true</Set>
					<Set name="particlesPerEmission">1</Set>
				</Emitter>
				<Particle>
					<Set name="sprite">s_shadow</Set>
					<Random name="offset" min="-8,-5020" max="8,-5020"/>
					<Set name="lifeTime">0.7</Set>
                    <Set name="inSpecificOrder">true</Set>
					<Set name="isBackgroundParticle">true</Set>
					<Set name="useGravity">false</Set>
					<Set name="gravityVector">0,25</Set>
	            	<Set name="flipX">true</Set>
					<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 0.8</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
					<Curve name="initialScale">
						<KeyFrame>0, 0.2, 0.2</KeyFrame>
						<KeyFrame>1, 0.2, 0.2</KeyFrame>
					</Curve>
				</Particle>
			</ParticleSystem>   
		<ParticleSystem name="particle_trail">
			<Emitter>
				<Set name="offset">-3,-5010</Set>
				<Set name="infLifeTime">true</Set>
				<Set name="infParticles">true</Set>
				<Set name="particlesPerEmission">4</Set>
				<Set name="intervalMin">.05</Set>
				<Set name="intervalMax">.15</Set>
				<Set name="randomizeInterval">true</Set>
			</Emitter>
			<Particle angleRelativeToPlayerSpeed="true" randomSpriteFrame="true">
				<Set name="sprite">s_trail</Set>
				<Random name="offset" min="-8,-5010" max="8,-4996"/>
				<Set name="lifeTime">0.7</Set>
				<Set name="isBackgroundParticle">true</Set>
				<Set name="useGravity">false</Set>
				<Set name="gravityVector">0,25</Set>
				<Set name="interpolateScale">true</Set>
				<Set name="initialScale">0.45, 0.68</Set>
				<Set name="finalScale">2, 0</Set>
				<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
				<Curve name="initialAlpha">
					<KeyFrame>0, 0.8</KeyFrame>
					<KeyFrame>1, 0</KeyFrame>
				</Curve>
			</Particle>
		</ParticleSystem>       
			<ParticleSystem name="break_particle" secondary="break_particle2">
				<Emitter>
					<Set name="particlesPerEmission">8</Set>
					<Set name="lifeTime">2</Set>
				</Emitter>
				<Particle randomSpriteFrame="true">
					<Set name="sprite">s_break</Set>
					<Set name="blendingMode">ADDITIVE</Set>
					<Set name="useGravity">true</Set>
					<Set name="interpolateScale">true</Set>
					<Set name="initialScale">1.2,1.2</Set>
					<Random name="finalScale" min="0.1, 0.1" max="0.4, 0.4"/>
					<Set name="lifeTime">1</Set>
					<RandomRadial name="initialVelocity" angleRange="30,330" radiusRange="80,200"/>
					<Set name="gravityVector">10, 35</Set>
					<Random name="initialRotationRate" min="-300" max="300"/>
					<Random name="posOffset" min="0.1, 0" max="10, 10.3"/>
				</Particle>
			</ParticleSystem>              
			<ParticleSystem name="break_particle2">
				<Emitter>
					<Set name="lifeTime">1</Set>
					<Set name="particlesPerEmission">1</Set>
					<Set name="particlesToEmit">80</Set>
					<Set name="emissionInterval">0.2</Set>
				</Emitter>
				<Particle>
					<Set name="sprite">s_break2</Set>
					<Set name="blendingMode">ADDITIVE</Set>
					<Set name="lifeTime">1.2</Set>
					<Set name="initialRotationRate">150</Set>
					<Curve name="initialScale">
						<KeyFrame>0, 0, 0</KeyFrame>
						<KeyFrame>0.4, 0.8, 0.8</KeyFrame>
						<KeyFrame>0.8, 0.3, 0.3</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
					<Curve name="initialAlpha">
						<KeyFrame>0, 0.5</KeyFrame>
						<KeyFrame>0.8, 0</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
					<Set name="initialVelocity">0,0</Set>
				</Particle>
			</ParticleSystem>  
			<ParticleSystem name="particle_death" updateStage="OnKilled">
				<Emitter>
					<Set name="offset">0, -0</Set>
					<Random name="emissionInterval" min="0.2" max="0.4" />
					<Set name="infParticles">true</Set>
					<Set name="lifeTime">1</Set>
					<Set name="particlesPerEmission">6</Set>
				</Emitter>
				<Particle>
					<Set name="sprite">s_death</Set>
					<Random name="offset" min="0, -0" max="3, -0" />
					<Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 0</KeyFrame>
						<KeyFrame>0.2, 0.6</KeyFrame>
						<KeyFrame>0.5, 1</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
					<Curve name="initialScale">
						<KeyFrame>0, 1.5, 1</KeyFrame>
						<KeyFrame>0.5, 1, 3</KeyFrame>
						<KeyFrame>1, 0, 4.5</KeyFrame>
					</Curve>					
                    <Random name="lifeTime" min="0.8" max="1" />
					<Set name="initialVelocity">0, -50</Set>
				</Particle>
			</ParticleSystem>                                                          
		</ParticleSystems>        
                 
		<RenderOptions>
			<Default>
				<Set name="UserNameOffset">30</Set>
				<Set name="IgnoreDefaultDamagedTileEffect">true</Set>
				<Set name="IgnoreDefaultDestroyedTileEffect">true</Set>
				<Set name="IgnorePunchTypeCheck">true</Set>
				<Set name="IncludeAllActions">true</Set>
				<Set name="PlayDefaultPunchAudio">false</Set>
				<Set name="PunchSoundOverride">SHOES</Set>
				<Set name="JumpEndStateRange">100</Set>
				<Set name="ClothingOffsetFromShoes">10000</Set>
				<Set name="IsRidingBird">true</Set>
				<Set name="IsVehicle">true</Set>
				<Set name="RenderShoesWithMermaidTail">true</Set>
				<Set name="ShoesHidesBodyLegs">true</Set>
				<Set name="IsToRenderPants">false</Set>
			</Default>
   	</RenderOptions>
            
		<StateMachines>
			<StateMachine name="Motion">
				<States>
					<State name="Idle" />
					<State name="Move" />
					<State name="Jump" />
					<State name="Fall" />
				</States>
				<Transitions>
					<Transition to="Idle" from="Fall|Move">
						<Condition type="and">
							<IsVariableBool name="onGround">true</IsVariableBool>
							<IsVariableFloat name="speed.length" operator="Less" abs="true">0.1</IsVariableFloat>
						</Condition>
					</Transition>
					<Transition to="Move" from="Jump|Fall|Idle">
						<Condition type="and">
							<IsVariableBool name="onGround">true</IsVariableBool>
							<IsVariableFloat name="speed.length" operator="Greater" abs="true">0.1</IsVariableFloat>
						</Condition>
					</Transition>
					<Transition to="Jump" from="Idle|Move">
						<Condition type="and">
							<IsVariableBool name="onGround">false</IsVariableBool>
							<IsVariableFloat name="speed.y" operator="Less">-0.1</IsVariableFloat>
						</Condition>
					</Transition>
					<Transition to="Fall" from="Jump|Idle|Move">
						<Condition type="and">
							<IsVariableBool name="onGround">false</IsVariableBool>
							<IsVariableFloat name="speed.y" operator="Greater">0.1</IsVariableFloat>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>
			<StateMachine name="Action1">
				<States>
					<State name="Idle"/>
					<State name="Punch"/>
					<State name="ZombiePunch"/>
				</States>
				<Transitions>
					<Transition from="ZombiePunch|Punch" to="Idle" >
						<Condition>
							<IsAction operatorType="NotEqual">PUNCH</IsAction>
						</Condition>
					</Transition>
					<Transition from="ZombiePunch|Idle" to="Punch">
						<Condition type="and">
							<IsAction>PUNCH</IsAction>
							<IsZombified>false</IsZombified>
						</Condition>
					</Transition>
					<Transition from="Idle|Punch" to="ZombiePunch">
						<Condition type="and">
							<IsAction>PUNCH</IsAction>
							<IsZombified>true</IsZombified>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>
			<StateMachine name="Facing">
				<States>
					<State name="Left"/>
					<State name="Right"/>
				</States>
				<Transitions>
					<Transition to="Left" from="Right">
						<Condition>
							<IsFacingLeft>true</IsFacingLeft>
						</Condition>
					</Transition>
					<Transition to="Right" from="Left">
						<Condition>
							<IsFacingLeft>false</IsFacingLeft>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>                 
		</StateMachines>     
	</Data>        
</ItemRenderer>